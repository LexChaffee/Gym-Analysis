---
title: "Gym Analysis Project"
author: "Lex Chaffee"
date: "2025-01-17"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Libraries, echo=FALSE, results="hide", message=FALSE, warning=FALSE}
library(ggplot2)
library(dplyr)
library(corrplot)
library(readr)
library(tidyverse)
```

# EDA 
```{r Data, echo=FALSE, results="hide", message=FALSE, warning=FALSE}
# read in data from csv file
gym_data <- read_csv("gym_members_exercise_tracking.csv")

# Shorten column names
colnames(gym_data) <- c("Age", "Gender", "Weight", "Height", "MaxBPM", "AvgBPM", "RestBPM", 
                  "Duration", "CaloriesBurned", "WorkoutType", "FatPct", "WaterIntake", "Freq", 
                  "ExpLvl", "BMI")

```

## Univariate Analysis

Get Basic Summary Statisics for all of the variables
```{r}
summary(gym_data)
```
Check for missingness in the data
```{r}
# Check missingness
is_na_df <- is.na(gym_data)

# Calculate missing counts and percentages
missing_count <- colSums(is_na_df)
missing_percent <- (missing_count / nrow(gym_data)) * 100

# Create a summary table
missing_table <- data.frame(
  Variable = names(missing_count),
  Missing_Count = missing_count,
  Missing_Percent = round(missing_percent, 2)
)

# Sort by missing percentage (optional)
missing_table <- missing_table[order(-missing_table$Missing_Percent), ]

# Print nicely
print(missing_table, row.names = FALSE)

```
None of the data is missing making analysis of the data easier. 

```{r}
#separate categorical from continuous
categorical <- gym_data |> select(c('Gender', 'WorkoutType', 'Freq', 'ExpLvl'))
continous <- gym_data |> select(-colnames(categorical))

```

## Unimodal EDA

```{r}
qqnorm(gym_data$Weight, main = "Normal Q-Q Plot (Normal Data)")
qqline(gym_data$Weight, col = "red")
```
```{r}
# Loop through each variable to create a QQ plot
for (variable_name in colnames(continous)) {
  print(variable_name)
  qqnorm(gym_data[[variable_name]],
         main = paste("Normal Q-Q Plot for", variable_name))

  # Add a red line to the QQ plot for visual comparison
  qqline(gym_data[[variable_name]], col = "red")

}

```




# Check for Multicollinearity







Split the dataset into a 70/30 train/test datasets
```{r}
set.seed(123)

gym_data <- gym_data %>% mutate(id = row_number())

train <- gym_data %>% sample_frac(0.7)

test <- anti_join(gym_data, train, by = 'id')
```


# Stepwise Regression

Let's now try creating a better model using stepwise regression:

```{r}
# Create full model and empty model
full.model <- lm(CaloriesBurned ~ . , data = train)
empty.model <- lm(CaloriesBurned ~ 1, data = train)
# k = 2 for AIC selection
step.model <- step(empty.model,
scope = list(lower = empty.model,
upper = full.model),
direction = "both", k = 2) 

```
Using stepwise regression, we find that the best model of Calories Burned are Duration, AvgBPM, Gender, Age, Height, and RestBPM.

Let's test that with an Multiple Linear Regression model

```{r}
mlr_model <- lm(CaloriesBurned ~ Duration + AvgBPM + Gender + Age + Height + RestBPM, data = gym_data)
summary(mlr_model)
```


